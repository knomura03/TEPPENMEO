# 監査ログの保存期間とアーカイブ運用

## 目的
- 監査ログを必要な期間だけ確実に保持し、容量と運用負荷を抑える
- 過去ログの調査に備えて、CSVで安全に退避できる状態を維持する

## 推奨方針（最小）
- オンライン保持: 直近 **180日**
- それ以前: CSVで退避し、必要に応じて削除
- 監査要件が厳しい場合は保持期間を延長する

## 運用フロー（チェックリスト）
- [ ] `/admin/audit-logs` で期間を指定する（例: 181日以前）
- [ ] フィルタ条件を確認し **CSVエクスポート** を実行する
- [ ] ファイル名を統一する（例: `audit-logs_YYYY-MM_環境名.csv`）
- [ ] 社内の保管場所に保存し、アクセス権を制限する
- [ ] 削除する場合は、承認者/実施者/日時を記録する

## 退避と削除の注意点
- CSVには機密キーがマスクされるが、運用情報は含まれるため取扱注意
- 監査要件に抵触しないか事前確認する
- 誤削除に備え、退避済みCSVの所在を必ず記録する

## よくある詰まり
### 出力件数が多すぎる
- 最大5000件までしか出力できない
- 期間やaction/組織で条件を細かく分けて再実行する

### CSVを開くと文字化けする
- UTF-8 BOM付きで出力される
- それでも崩れる場合はExcelのインポート設定で文字コードを指定する
